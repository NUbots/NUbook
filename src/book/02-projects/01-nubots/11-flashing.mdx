---
section: Projects
chapter: NUbots
title: Flashing a Robot
description: How to installing a new operating system on the robot
slug: /projects/nubots/flashing
---

## Flashing a Robot

To install Arch Linux (our OS of choice) on to a robot perform the following instructions

1. Download the latest [Arch Linux LiveUSB](https://www.archlinux.org/download/) image and burn it on to a [USB thumb drive](https://wiki.archlinux.org/index.php/USB_flash_installation_media#In_GNU/Linux)
1. Boot into the LiveUSB environment on the robot and ensure the robot has an active network connection

   - Run `ip addr` and look for a `inet` line that has a valid IP address on it. If you can't see one you don't have a network connection. Alternatively, run `ping google.com` and look for a response time.
   - If you have no connection and need to set up the WiFi interface, see below.

1. Download the installation script [https://git.io/JeWaF](https://git.io/JeWaF) and make sure the script is executable

   - The installation script is located in the NUbots repository at [doc/ArchInstall/arch_install.sh](https://github.com/NUbots/NUbots/blob/master/doc/ArchInstall/arch_install.sh)
   - ```sh
     wget https://git.io/JeWaF -O ./arch_install.sh
     chmod +x ./arch_install.sh
     ```

1. Execute the script and follow the instructions
   - ```sh
     ./arch_install.sh
     ```

The installation script will end by downloading a secondary script and providing you with a command that you must run

```sh
ROBOT_NUMBER=<N> arch-chroot /mnt ./arch-chroot_install.sh
```

Substitute `<N>` with the number of the robot that you are building. This will influence the IP address of the robot as well as the robots' hostname.

Finally, once that script has finished, you must run one more command.

```sh
/mnt/arch-post_install.sh
```

This command will end by rebooting the robot. When this happens be sure to remove the USB installation drive from robot so that you may boot into the new system.

The final two scripts can be found at [doc/ArchInstall/arch-chroot_install.sh](https://github.com/NUbots/NUbots/blob/master/doc/ArchInstall/arch-chroot_install.sh) and [doc/ArchInstall/arch-post_install.sh](https://github.com/NUbots/NUbots/blob/master/doc/ArchInstall/arch-post_install.sh)

## Manually setting up a WiFi connection on the robot

To set up the WiFi interface you first need to know the name of the interface. To find this, run

```sh
ip link
```

and look for an interface starting with `wl`. On our robots it is usually `wlp58s0`.

The rest of these instructions assume a network using WPA2 (like the network used in the NUbots lab).

1. Make sure the `wpa_supplicant` configuration directory exists

   - ```sh
     mkdir /etc/wpa_supplicant
     ```

1. Setup the network configuration

   - ```sh
     wpa_passphrase <Network SSID> <Network Passphrase> > /etc/wpa_supplicant/wpa_supplicant-<WiFi Interface>.conf
     ```
   - Be sure to replace `<Network SSID>` with the SSID of the wireless network to connect to (either `epsilon-x` or `epsilon-z` in the lab), `<Network Passphrase>` with the password for the network (ask someone for the lab password if you don't know it), and `<WiFi Interface>` with the name of the interface found earlier.

1. Now start all of the necessary services

   - ```sh
     systemctl start dhcpcd.service
     systemctl start wpa_supplicant.service
     systemctl start wpa_supplicant@<Wifi Interface>.service
     ```
   - Be sure to replace `<WiFi Interface>` with the name of the interface found earlier.
   - Wait a handful of seconds and run `ip addr` to check that the WiFi interface has an IP address
