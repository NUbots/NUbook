---
section: Guides
chapter: NUbots
title: Recording and Playback
description: Recording data and playing it back.
slug: /guides/nubots/recording-playback
---

NUbots data is stored in [NUClear Binary Stream (NBS) files](/system/nubots/nuclear#nbs-files). Any [messages](https://github.com/NUbots/NUbots/tree/master/shared/message) that are passed around the NUbots system can be recorded.

# Recording Data

The following steps detail how to record data.

1. Set up the role. Most of the time this involves making minor changes to an existing role.

   1. The role must contain the module/s which emit the message/s you want to record.
   2. The role must contain the module `support::logging::DataLogging`.

   For example, you may want to record [Sensors](https://github.com/NUbots/NUbots/blob/master/shared/message/input/Sensors.proto) messages. You would use the existing [sensortest](https://github.com/NUbots/NUbots/blob/master/roles/sensortest.role) role and add `support::logging::DataLogging` to it.

2. Build the code and install it to a robot. To find out how to do this, visit the [Getting Started](/guides/nubots/getting-started) page.

3. Make changes to the `DataLogging.yaml` configuration file.

   1. On the robot, open the file in your favourite editor, eg `nano config/DataLogging.yaml`.
   2. Set all messages you would like to record to `true`.
   3. Save and exit.

   In our example, we would want to set all `input::sensors::` messages to true.

4. Run the binary. In our example, this would be `./sensortest`.

5. Stop the binary when you have finished recording by pressing <kbd>CTRL</kbd> + <kbd>c</kbd>.

6. Move the newly created NBS file to a computer for safe storage.
   1. The NBS file will be located on the robot in the `log/role_name/` folder. The name will correspond to the time and date it was created, according to the robot's clock. Make note of the name. In our example, this may be `log/sensortest/18072020T082100.nbs`.
   2. Copy the file across. On the destination computer, run `scp nubots@<address>:log/role_name/file_name path/to/destination`. In our example, we may want to run `scp nubots@<address>:log/sensortest/18072020T082100.nbs .`. The file will then be copied to the folder you ran the command in. `<address>` corresponds to the address of the robot.

# Extracting Data

The NBS file is not easily understood by humans. Certain tools in the NUbots codebase convert NBS files to file formats that are easier for us to understand.

The tools are run with the **b** script in the NUbots codebase. [NBS tools](https://github.com/NUbots/NUbots/tree/master/tools/nbs) have the argument `nbs`.

Tools are executed by running

```sh
./b nbs <tool_name> <nbs_file_name>
```

| Tool Name         | Description                                                                                                                               | Arguments                                                                                                                                                                                                                                                                                                                                                                                                      |
| ----------------- | ----------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| stats             | Decodes an NBS file into a series of file statistics.                                                                                     | --message-timestamp uses the message's `.timestamp` field as the time of the message.                                                                                                                                                                                                                                                                                                                          |
| json              | Outputs the data in the NBS file to a JSON file. It is useful to redirect the output to a file by appending `> file.json` to the command. | -                                                                                                                                                                                                                                                                                                                                                                                                              |
| extract_images    | Decodes an NBS file and extracts any compressed jpeg files into jpeg files.                                                               | --output specifies the folder to save the images to.                                                                                                                                                                                                                                                                                                                                                           |
| video             | This will take images in an NBS file and create a video.                                                                                  | --output specifies the folder to save the video to. --quality specifies the quality to save the video in. --encoder specifies the encoder to use when encoding the video.                                                                                                                                                                                                                                      |
| calibrate_cameras | Calculate camera intrinsics using an NBS recording of asymmetric circles grid patterns.                                                   | --config the path to the directory containing the camera configuration files. --rows the number of rows in the asymmetric circles grid. --cols the number of columns in the asymmetric circles grid. --grid_size the distance between rows/cols in the grid in meters. -- no-intrisics does not change the intrinsic configuration values. --no-extrinsics does not change the extrinsic configuration values. |
| footdown          | Trains a foot down network using sensor data from the legs.                                                                               | -                                                                                                                                                                                                                                                                                                                                                                                                              |
