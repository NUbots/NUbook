---
section: Guides
chapter: General
title: Git
description: How to contribute to a NUbots project using Git.
slug: /guides/general/git
---

## Prerequisites

This guide assumes you know the basics of using a command line (also called a terminal). Specifically, it assumes you know how to navigate around the filesystem and run commands. You can [learn how to use the command line in this article](https://www.freecodecamp.org/news/conquering-the-command-line-f85f5e46c07c/). If you are on Windows, you should [install WSL to use the Bash terminal](https://docs.microsoft.com/en-us/windows/wsl/install-win10), since many of the commands you will be using are not available in the default Command Prompt.

It also assumes you know the basics of using Git, such as cloning a repository, adding and committing changes, and pushing your changes to a remote. If you don't, you can [learn about that in this short introduction to Git](https://www.freecodecamp.org/news/learn-the-basics-of-git-in-under-10-minutes-da548267cc91/).

## Getting Code Into a Repository

Let's suppose you have created a file which you would like to add to a NUbots repository called `MakeRobotStand.cpp`, which is part of your project to make the robot stand up.

In the terminal, change directory to the location where the repository is cloned.

### Select Branch

If you are working within an existing project, then you need to find out which branch the work is on. To list the branches, use the command `git branch -r`. When you have found the branch you want to push to, swap to it using the following command:

```sh
git checkout <branch name>
```

Where `<branch name>` corresponds to the branch you found in the last step.

If you are not working on an existing project, you need to make a branch to commit your changes to. The format for branch names is `your_surname/brief_description_of_project`. So if your surname is Hamiltons, and your project is making the robot stand up, a good branch name would be `hamiltons/stand_up`.

### Making a Pull Request

Once you have a set of commits on your branch which you think should be added to the main codebase, you can make a Pull Request (PR). PRs are where users ask the repository to pull their branch into the `master` branch.

GitHub has [documentation about PRs here](https://help.github.com/en/github/collaborating-with-issues-and-pull-requests/creating-a-pull-request).

Title your PR with a description of the changes that it will make. For this example we could use `Add stand-up script`. If you need to give more detail about what the code does, put that as a comment.

To be approved, you should add reviewers to the pull request. If you have a project mentor, they should be a reviewer, as well as someone else who knows about that part of the codebase. Once the reviewers have approved the changes, the changes can be merged into the master branch.

### Code Review

When making a PR you can select a number of reviewers to review your code, they will get a notification. Please choose people that you feel will be able to understand the problem your code is trying to solve.

The reviewers will give constructive feedback about your code, by making comments on code snippets from your changes. You can respond to these on GitHub. They can also directly suggest changes to specific sections. Additional commits you make to the branch will update the PR and will reset reviews of the changed sections.

Once all of the comments are resolved, the reviewers have approved the PR, and the build checks have passed (see [_Formatting and Buildkite Checks_](#formatting-and-buildkite-checks)), you can **Squash and Merge**. Squashing combines every commit on the PR into a single commit so that the `master` branch history is clean and easy to follow. Once the code has been squashed and merged, it is in the codebase and you have succeeded in contributing code to NUbots.

## Commit Etiquette

Commits should make minor changes, and the changes in each commit should have a common theme. A general mantra for contributing code is **commit often, push once**, but this isn't strict at all. Committing often means that the code is built up incrementally. Pushing once means that you don't spam all the other contributors with notifications.

Commit messages should describe what you did, starting with an action verb in the <abbr title="Why? Think of your commit message as completing the sentence 'When applied, this commit will ...'">present tense</abbr>. If you added a file with a new stand script, for example, prefer "Add new stand script" over "Added new stand script" or "Adding new stand script" or "Add script".

## Formatting and Buildkite Checks

Before making a pull request, it is important that your code adheres to the code style and formatting rules for the project you are contributing to.

- For code in the [NUbots](https://github.com/NUbots/NUbots) repository, run `./b format` to fix formatting issues before making a commit.
- For code in [NUsight](https://github.com/NUbots/NUsight2), run `yarn eslint:fix` to fix formatting issues before making a commit.
- For code in [NUbook](https://github.com/NUbots/NUbook), run `yarn format` to fix formatting issues before making a commit.

If your code is in a different repository and it uses C++ or protobuf files, use the `.clang-format` file in the NUbots repo to format them.

If you push your changes to GitHub and get a message that the build failed due to formatting issues, try running the relevant format commands, commit any changes, and push to GitHub again. This will trigger a new build, which will check the formatting again. You won't be able to merge the PR until the build checks pass.

## Reviewing Code

To review code on GitHub open up a PR and open the Files Changed tab. This will give you the diff of the PR. You can click on the lines of code in the diff to add a comment and/or a suggestion to those lines. You can either leave a single comment or start a review. In a review all comments you make will have pending written on them to say that they have not been posted yet. Please make each comment non-ambiguous and clearly state what your concern is.

When reading the code, if there is anything that confuses you or think is incorrect make a comment with all your concerns. For example, if there is a nontrivial block of code without a comment explaining it you should ask for the author to provide such a comment. Another example is if there is a block of code that could do something that the autor may have not considered you should inform the author, with a comment, on what these other effects may be.

When finished reading the code and you have a bunch of pending comments for your review you can do one of three things. The first is to request changes, this blocks the code from being merged until you approve the branch, even if others have approved it. The second is to approve the PR, this allows it to be merged into master, don't do this unless you are confident that the code is correct. The third is to leave a comment, do this if you are not too concerened about the comments you have made.

Reviewing code that you may not be fully confident with and leaving comments on helps both yourself learn and the author make more readable code.

## Writing Reviewable Code and Reviewee Etiquette

Writting reviewable code is an art, here are some guidelines that you should stick to to make it easier for reviews:

- **Atomicity**: A reviewable PR should only address one issue or add one feature.
- **Length**: A reviewable PR should not change much more than 400 lines of code, anything above this super-exponentioally increases the time it takes to review.
- **Name**: A reviewable PR should have a verb saying what you did the the issue fixed or the feature added.

To keep PRs small and atomic you may have to split your PR into multiple sub PRs. To do this make a new branch for the sub PR and move over some code. Then make a seperate PR and mention it in the original PR with `#123` where `123` is the PR number. After chanining the sub PR merge it back into the original PR.

When your code is being reviewed and reviewers add comments, if you can answer these concerns in the code with comments, do so, as in the furture people don't have to read through hundreds of PRs and can instead just read the code. When this is done you can press Resolve Conversation and this will hide the conversation. Don't be alarmed when a reviewer make over a dozen comments on your PR, just work through them systematically. Finally when all the comments have been addressed from a reviewer that has requested changes you can request that they review your code by pressing the Re-request review button.

## Work in Progress PRs

If you have an incomplete project you would like feedback on, you can make a draft PR to get your code reviewed. Prepend `[WIP]` to the PR title when making draft pull requests. Draft PRs cannot be merged, so there is no need to worry about merging in bad code. GitHub has [documentation about draft PRs here](https://help.github.com/en/github/collaborating-with-issues-and-pull-requests/about-pull-requests#draft-pull-requests).
