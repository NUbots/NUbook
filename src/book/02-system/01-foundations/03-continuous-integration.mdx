---
section: System
chapter: Foundations
title: Continuous Integration
description: The NUbots continuous integration system.
slug: /system/foundations/ci-system
authors:
  - Josephus Paye II (@JosephusPaye)
  - Joel Wong (@wongjoel)
  - Yosiah de Koeyer (@Y0sh1dk)
  - Kip Hamiltons (@KipHamiltons)
---

## Overview

NUbots uses [GitHub Actions](https://github.com/features/actions) for its continuous integration pipelines. The pipelines are triggered automatically when pull requests are made, updated, or merged. The pipelines build and test the code on GitHub's cloud, with logs and results available on the GitHub website, associated with the relevant pull request.

## Branch Workflow

**This section assumes basic knowledge of Git. If you need a git refresher, see the [Git guide](/guides/general/git).**

This CI process works in combination with the [Git Feature Branch workflow](https://www.atlassian.com/git/tutorials/comparing-workflows/feature-branch-workflow) we use for development:

1. Developers branch off `main`, creating a new branch with a name of the form `<lastname>/<purpose-of-branch>`. For example:

   ```bash
   # Make sure main is up to date before creating your branch
   git fetch
   git checkout main
   git pull

   # Create and check out the branch off of main
   git checkout -b biddulph/ball-detector
   ```

2. Once development on the branch is complete, or reaches a point where it can be reviewed, the developer makes a pull request (PR) on GitHub. Creating the pull request triggers a GitHub action runners to check the code. GitHub automatically creates separate build runners for different parts of the PR (build, check code format, test, etc).
3. Each runner completes a set of tasks specific in a pipeline file, found inside the [`.github/workflows`](https://github.com/NUbots/NUbots/tree/7cc0677eda6629c2b445a35473748c163685aaad/.github/workflows) directory of the codebase. These steps usually involve cloning the codebase, checking out the relevant commit, pulling down the docker image (rebuilding it if it has changed), then doing checking some aspect of the code.
4. GitHub logs the results of each job and displays the results on the webpage for the pull request. The logs are viewable in the 'actions' tab of the PR.
5. Once the build passes, the PR is reviewed by another member of the team. Once the PR has been approved, it can be merged into `main`.
6. Merging the PR into `main` then triggers another CI build. This time, in addition to building the code, a separate job is created to rebuild the main docker images and push them to DockerHub. This is the main way that our docker images are kept up to date.

<TabbedImages>

!['Diagram of CI Overview for pull requests'](./images/ci-overview-pr.svg 'CI Overview PR')

!['Diagram of CI Overview for master'](./images/ci-overview-master.svg 'CI Overview Master')

</TabbedImages>

## The Build Pipeline

The GitHub Actions are configured in [workflow files](https://github.com/NUbots/NUbots/tree/7cc0677eda6629c2b445a35473748c163685aaad/.github/workflows) in the NUbots repo. To add, remove, or change build jobs, we edit the relevant workflow file. The [GitHub Actions documentation](https://docs.github.com/en/actions) should be your first stop when you want to make changes.

## Monitoring and Troubleshooting Builds

GitHub Actions have live-updating logs of each build, which you can use to monitor the build progress or troubleshoot errors when a build fails.

Failed builds and pipeline steps can be diagnosed by viewing their logs.
To view them, scroll to the build checks at the bottom of the PR page and click the **Details** link on the `buildkite/nubots/pr` check.

Failed steps usually require changes to your pull request. Pushing your updated branch to GitHub automatically triggers a fresh build, with no extra steps required. The build status of your pull request will automatically update with the results.

![Screenshot of the build checks section of the PR page, with arrow pointing to primary link](./images/ci-build-logs.png 'Link to the build details with logs')
